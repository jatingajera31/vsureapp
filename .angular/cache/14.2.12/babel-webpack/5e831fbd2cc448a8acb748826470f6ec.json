{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/app/services/api-services.service\";\nimport * as i3 from \"src/app/services/vehical.service\";\nimport * as i4 from \"ngx-toastr\";\nimport * as i5 from \"@angular/common\";\n\nfunction MyDocumentsComponent_option_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 11);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const vehical_r2 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", vehical_r2.CustAssetId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", vehical_r2.CustMake, \" \");\n  }\n}\n\nfunction MyDocumentsComponent_div_16_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"img\", 13);\n    i0.ɵɵelementStart(2, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function MyDocumentsComponent_div_16_div_1_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const img_r3 = i0.ɵɵnextContext().$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.deletePhotoDocs(img_r3.PhotoID));\n    });\n    i0.ɵɵtext(3, \"delete\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const img_r3 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"src\", img_r3.AbsoultePathURL, i0.ɵɵsanitizeUrl);\n  }\n}\n\nfunction MyDocumentsComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, MyDocumentsComponent_div_16_div_1_Template, 4, 1, \"div\", 12);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const img_r3 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", img_r3.AbsoultePathURL && img_r3.AbsoultePathURL != null);\n  }\n}\n\nexport let MyDocumentsComponent = /*#__PURE__*/(() => {\n  class MyDocumentsComponent {\n    constructor(formBuilder, ApiServicesService, vehicalService, toastrService) {\n      this.formBuilder = formBuilder;\n      this.ApiServicesService = ApiServicesService;\n      this.vehicalService = vehicalService;\n      this.toastrService = toastrService;\n    }\n\n    ngOnInit() {\n      this.loginData = JSON.parse(localStorage.getItem('loginToken'));\n      this.imageForm = this.formBuilder.group({\n        imageFile: [null],\n        vehical: []\n      });\n      this.getAllAssetList();\n    }\n\n    getAllAssetList() {\n      let asset = {\n        \"CustomerId\": this.loginData.UserID,\n        \"EmployeeId\": \"\",\n        \"EmployerId\": \"\",\n        \"AdharId\": \"\",\n        \"RegistrationNo\": \"\",\n        \"PolicyNo\": \"\"\n      };\n      this.ApiServicesService.getToken().subscribe(data => {\n        this.ApiServicesService.getAssetList(asset, data).subscribe(data => {\n          this.vehicalList = JSON.parse(data)[0].Details[0].CustomerAssets;\n          console.log(\"vehical list\", this.vehicalList); // this.toastrService.success('successfully register')\n          // this.router.navigate(['/']);\n        });\n      });\n    }\n\n    getVehicleDocImage(e) {\n      this.serviceNumber = e.target.value;\n      let payload = {\n        \"ServiceNumber\": this.serviceNumber,\n        \"Filter\": \"CustAsstService\"\n      };\n      this.ApiServicesService.getToken().subscribe(data => {\n        this.ApiServicesService.getDocumentImg(payload, data).subscribe(data => {\n          this.vehicalDocsImg = data;\n          console.log(\"vehical docs image\", this.vehicalDocsImg); // this.toastrService.success('successfully register')\n          // this.router.navigate(['/']);\n        });\n      });\n    }\n\n    deletePhotoDocs(photoId) {\n      let payload = {\n        \"ServiceNumber\": this.serviceNumber,\n        \"Filter\": \"CustAsstService\",\n        \"PhotoID\": JSON.stringify(photoId) //PhotoID will get from GetPhotoDocumentsAPI\n\n      };\n      this.ApiServicesService.getToken().subscribe(data => {\n        this.ApiServicesService.deletePhotoDocs(payload, data).subscribe(data => {\n          this.vehicalDocsImg = data;\n          console.log(\"vehical docs image\", this.vehicalDocsImg);\n          this.toastrService.success('Delete Photo Docs successfully.');\n        });\n      });\n    }\n\n    onFileChange(event) {\n      if (event.target.files && event.target.files.length) {\n        const file = event.target.files[0];\n        console.log(\"file\", file);\n        this.fileName = file.name;\n        const reader = new FileReader();\n        reader.readAsDataURL(file);\n\n        reader.onload = () => {\n          this.imageForm.patchValue({\n            imageFile: reader.result // Set the base64 string to the form control\n\n          });\n        };\n\n        console.log(\"imageFile\", reader.result);\n      }\n    }\n\n    onSubmit() {\n      // Handle form submission and send the base64 image string\n      const base64Image = this.imageForm.get('imageFile').value;\n      var dataWithoutPrefix = base64Image.substring(base64Image.indexOf(',') + 1);\n      console.log('Base64 Image:', base64Image);\n      console.log(\"this.imageForm.value.vehical\", this.imageForm.value.vehical);\n      console.log(\"this.imageForm.value.vehical.split(\", \")[0]\", this.imageForm.value.vehical.split(\",\")[0]);\n      let uploadFile = {\n        \"ServiceNumber\": this.imageForm.value.vehical.split(\",\")[0],\n        \"Service\": \"CustAsstService\",\n        \"Latitude\": \"\",\n        \"Longitude\": \"\",\n        \"FileStream\": dataWithoutPrefix,\n        \"FileName\": this.fileName,\n        \"Category\": \"Driving License\",\n        \"PhotoType\": \"Document Photos\"\n      }; // Call API or perform any other action with the base64 image\n\n      console.log(\"dataWithoutPrefix\", dataWithoutPrefix);\n      this.vehicalService.fileUpload(uploadFile).subscribe(res => {\n        console.log(\"res\", res);\n      });\n    }\n\n  }\n\n  MyDocumentsComponent.ɵfac = function MyDocumentsComponent_Factory(t) {\n    return new (t || MyDocumentsComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.ApiServicesService), i0.ɵɵdirectiveInject(i3.VehicleService), i0.ɵɵdirectiveInject(i4.ToastrService));\n  };\n\n  MyDocumentsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: MyDocumentsComponent,\n    selectors: [[\"app-my-documents\"]],\n    decls: 17,\n    vars: 3,\n    consts: [[1, \"card\"], [1, \"heading\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"py-2\", \"d-flex\", \"main-menu\"], [1, \"d-flex\", \"sub-menu\"], [\"formControlName\", \"vehical\", 1, \"browser-default\", \"custom-select\", 3, \"change\"], [\"selected\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"file\", \"accept\", \"image/*\", 3, \"change\"], [\"type\", \"submit\"], [4, \"ngFor\", \"ngForOf\"], [3, \"value\"], [4, \"ngIf\"], [\"alt\", \"\", \"width\", \"100\", \"height\", \"100\", 3, \"src\"], [3, \"click\"]],\n    template: function MyDocumentsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵtext(2, \"Upload Document\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\")(4, \"form\", 2);\n        i0.ɵɵlistener(\"ngSubmit\", function MyDocumentsComponent_Template_form_ngSubmit_4_listener() {\n          return ctx.onSubmit();\n        });\n        i0.ɵɵelementStart(5, \"div\", 3)(6, \"div\", 4)(7, \"label\");\n        i0.ɵɵtext(8, \"Select Vehical:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"select\", 5);\n        i0.ɵɵlistener(\"change\", function MyDocumentsComponent_Template_select_change_9_listener($event) {\n          return ctx.getVehicleDocImage($event);\n        });\n        i0.ɵɵelementStart(10, \"option\", 6);\n        i0.ɵɵtext(11, \"select\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(12, MyDocumentsComponent_option_12_Template, 2, 2, \"option\", 7);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(13, \"input\", 8);\n        i0.ɵɵlistener(\"change\", function MyDocumentsComponent_Template_input_change_13_listener($event) {\n          return ctx.onFileChange($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"button\", 9);\n        i0.ɵɵtext(15, \"Upload Image\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(16, MyDocumentsComponent_div_16_Template, 2, 1, \"div\", 10);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"formGroup\", ctx.imageForm);\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"ngForOf\", ctx.vehicalList);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", ctx.vehicalDocsImg);\n      }\n    },\n    dependencies: [i5.NgForOf, i5.NgIf, i1.ɵNgNoValidate, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i1.SelectControlValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName],\n    styles: [\".card[_ngcontent-%COMP%]{padding:20px}.card[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:22px;padding:10px 0}\"]\n  });\n  return MyDocumentsComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}